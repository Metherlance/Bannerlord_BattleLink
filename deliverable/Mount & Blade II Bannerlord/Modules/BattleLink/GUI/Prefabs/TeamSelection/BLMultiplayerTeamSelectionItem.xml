<Prefab>
  <Parameters>
    <Parameter Name="IsAtLeft" DefaultValue="true" />
  </Parameters>
  <Constants>
    <Constant Name="BannerBrush" BooleanCheck="*IsAtLeft" OnTrue="MPTeamSelection.Banner.Left" OnFalse="MPTeamSelection.Banner.Right" />
    <Constant Name="AvatarList.HorizontalAlignment" BooleanCheck="*IsAtLeft" OnTrue="Left" OnFalse="Right" />
    <Constant Name="AvatarList.MarginLeft" BooleanCheck="*IsAtLeft" OnTrue="35" OnFalse="0" />
    <Constant Name="AvatarList.MarginRight" BooleanCheck="*IsAtLeft" OnTrue="0" OnFalse="35" />

    <Constant Name="LockImage.XOffset" BooleanCheck="*IsAtLeft" OnTrue="22" OnFalse="-22" />

    <Constant Name="Banner.HorizontalAlignment" BooleanCheck="*IsAtLeft" OnTrue="Right" OnFalse="Left" />
    <Constant Name="Banner.Width" BrushName="!BannerBrush" BrushLayer="Default" BrushValueType="Width"/>
    <Constant Name="Banner.Height" BrushName="!BannerBrush" BrushLayer="Default" BrushValueType="Height"/>

    <Constant Name="AvatarFrame.Width" BrushName="MPTeamSelection.AvatarFrame" BrushLayer="Default" BrushValueType="Width"/>
    <Constant Name="AvatarFrame.Height" BrushName="MPTeamSelection.AvatarFrame" BrushLayer="Default" BrushValueType="Height"/>

    <Constant Name="LockBackground.Width" BrushName="MPTeamSelection.LockBackground" BrushLayer="Default" BrushValueType="Width"/>
    <Constant Name="LockBackground.Height" BrushName="MPTeamSelection.LockBackground" BrushLayer="Default" BrushValueType="Height"/>
  </Constants>
  <Window>
    <Widget DoNotAcceptEvents="true" WidthSizePolicy = "CoverChildren" HeightSizePolicy = "CoverChildren" >
      <Children>
        <ListPanel DataSource = "{FriendAvatars}" StackLayout.LayoutMethod = "VerticalBottomToTop" WidthSizePolicy = "CoverChildren" HeightSizePolicy = "CoverChildren" HorizontalAlignment = "!AvatarList.HorizontalAlignment" VerticalAlignment="Top" MarginTop="140">
          <ItemTemplate>
            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="50" SuggestedHeight="50" MarginBottom="5">
              <Children>
                <ImageIdentifierWidget DataSource="{Avatar}" DoNotAcceptEvents="true" ImageId="@Id" AdditionalArgs="@AdditionalArgs" ImageTypeCode="@ImageTypeCode" WidthSizePolicy = "StretchToParent" HeightSizePolicy = "StretchToParent" SuggestedWidth = "50" SuggestedHeight = "50" HorizontalAlignment="Center" VerticalAlignment="Center" />
              </Children>
            </Widget>
          </ItemTemplate>
        </ListPanel>
        <TextWidget Text="@FriendsExtraText" IsVisible="@HasExtraFriends" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!AvatarFrame.Width" SuggestedHeight="!AvatarFrame.Height" HorizontalAlignment = "!AvatarList.HorizontalAlignment" MarginTop="550" Brush="MPTeamSelection.ExtraFriendsText">
          <Children>
            <HintWidget DataSource="{FriendsExtraHint}" DoNotAcceptEvents="true" WidthSizePolicy = "StretchToParent" HeightSizePolicy = "StretchToParent" Command.HoverBegin="ExecuteBeginHint" Command.HoverEnd="ExecuteEndHint" />
          </Children>
        </TextWidget>

        <NavigationScopeTargeter ScopeID="TeamSelectionItemScope" ScopeParent="..\Button" />
        <ButtonWidget Id="Button" Command.Click="ExecuteSelectTeam" UpdateChildrenStates="true" DoNotPassEventsToChildren="true" IsDisabled="@IsDisabled" WidthSizePolicy = "Fixed" HeightSizePolicy = "Fixed" SuggestedWidth = "!Banner.Width" SuggestedHeight = "!Banner.Height" MarginTop="50" MarginBottom="60" VerticalAlignment = "Center" HorizontalAlignment = "!Banner.HorizontalAlignment" MarginLeft="!AvatarList.MarginLeft" MarginRight="!AvatarList.MarginRight" GamepadNavigationIndex="0">
          <Children>

            <Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="63" SuggestedHeight="41" HorizontalAlignment="Center" PositionYOffset="-90" IsVisible="@IsSiege" UpdateChildrenStates="true">
              <Children>
                <BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="63" SuggestedHeight="41" Brush="MPHud.Defender.Icon" HorizontalAlignment="Center" IsHidden="@IsAttacker"/>
                <BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="63" SuggestedHeight="41" Brush="MPHud.Attacker.Icon" HorizontalAlignment="Center" IsVisible="@IsAttacker"/>
              </Children>
            </Widget>


            <TextWidget IntText="@Score" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" PositionYOffset="-85" Brush="MPTeamSelection.ScoreText" IsHidden="@IsSiege"/>

            <!-- <TextWidget IsDisabled="@IsDisabled" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" VerticalAlignment="Top" HorizontalAlignment="Center" PositionYOffset="-50" Brush="MPTeamSelection.FactionNameText" Text="@DisplayedPrimary"/> -->

			<!-- original code: https://github.com/Byak0/Alliance/blob/dev/Alliance.Client/_Module/GUI/Prefabs/TeamSelection/AL_MultiplayerTeamSelectionItem.xml -->
			<!-- Replace original MultiplayerFactionBannerWidget by an ImageIdentifierWidget showing banner from banner code -->
			<!-- <MultiplayerFactionBannerWidget UpdateChildrenStates="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" FactionCode="@CultureId" BannerWidget="Banner" IconWidget="Icon" CultureColor1="@CultureColor1" CultureColor2="@CultureColor2"> -->
              <!-- <Children> -->
                <!-- <BrushWidget Id="Banner" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="!BannerBrush" /> -->
                <!-- <Widget Id="Icon" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="220" SuggestedHeight="220" HorizontalAlignment="Center" VerticalAlignment="Center" PositionYOffset="-30"/> -->
              <!-- </Children> -->
            <!-- </MultiplayerFactionBannerWidget> -->
			<Widget UpdateChildrenStates="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" >
				<Children>
					<BrushWidget Id="Banner" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="360" SuggestedHeight="360" Brush="MPScoreboard.EndOfBattle.ResultBackground" Brush.Color="@CultureColor1" HorizontalAlignment="Center" VerticalAlignment="Center" PositionYOffset="10">
						<Children>
							<!-- Banner generated by banner code -->
							<ImageIdentifierWidget DataSource="{Banner}" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="352" SuggestedHeight="352" HorizontalAlignment="Center" VerticalAlignment="Center" ImageId="@Id" AdditionalArgs="@AdditionalArgs" ImageTypeCode="@ImageTypeCode" />
							<!-- Blend with background -->
							<BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="352" SuggestedHeight="352" Brush="Mission.TakenDamage.Left" Brush.Color="#000000FF" AlphaFactor="1" HorizontalAlignment="Center" VerticalAlignment="Center" PositionYOffset="0" ExtendLeft="20"/>
							<BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="352" SuggestedHeight="352" Brush="Mission.TakenDamage.Right" Brush.Color="#000000FF" AlphaFactor="1" HorizontalAlignment="Center" VerticalAlignment="Center" PositionYOffset="0" ExtendLeft="20" />
							<BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="352" SuggestedHeight="352" Brush="Mission.TakenDamage.Top" Brush.Color="#000000FF" AlphaFactor="1" HorizontalAlignment="Center" VerticalAlignment="Center" PositionYOffset="0" ExtendLeft="20"/>
							<BrushWidget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="352" SuggestedHeight="352" Brush="Mission.TakenDamage.Bottom" Brush.Color="#000000FF" AlphaFactor="1" HorizontalAlignment="Center" VerticalAlignment="Center" PositionYOffset="0" ExtendLeft="20" />
							<!-- Leader preview-->
							<!-- <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent"> -->
								<!-- <Children> -->
									<!-- <CharacterTableauWidget DataSource="{Troop1Preview}" WidthSizePolicy="Fixed" SuggestedWidth="250" HeightSizePolicy ="Fixed" SuggestedHeight="250" HorizontalAlignment="Center" VerticalAlignment="Center" PositionYOffset="42" PositionXOffset="!TroopPreview1.XOffset" BodyProperties="@BodyProperties" IsFemale="@IsFemale" EquipmentCode="@EquipmentCode" CharStringId="@CharStringId" StanceIndex="@StanceIndex" BannerCodeText="@BannerCodeText" MountCreationKey="@MountCreationKey" ArmorColor1="@ArmorColor1" ArmorColor2="@ArmorColor2" Race="@Race" IdleAction="@IdleAction" IsPlayingCustomAnimations="@IsPlayingCustomAnimations" ShouldLoopCustomAnimation="@ShouldLoopCustomAnimation" CustomAnimationWaitDuration="@CustomAnimationWaitDuration" CustomAnimation="@CustomAnimation" LeftHandWieldedEquipmentIndex="@LeftHandWieldedEquipmentIndex" RightHandWieldedEquipmentIndex="@RightHandWieldedEquipmentIndex" DoNotUseCustomScale="true" /> -->
									<!-- <CharacterTableauWidget DataSource="{Troop2Preview}" WidthSizePolicy="Fixed" SuggestedWidth="220" HeightSizePolicy ="Fixed" SuggestedHeight="220" HorizontalAlignment="Center" VerticalAlignment="Center" PositionYOffset="52" PositionXOffset="!TroopPreview2.XOffset" BodyProperties="@BodyProperties" IsFemale="@IsFemale" EquipmentCode="@EquipmentCode" CharStringId="@CharStringId" StanceIndex="@StanceIndex" BannerCodeText="@BannerCodeText" MountCreationKey="@MountCreationKey" ArmorColor1="@ArmorColor1" ArmorColor2="@ArmorColor2" Race="@Race" IdleAction="@IdleAction" IsPlayingCustomAnimations="@IsPlayingCustomAnimations" ShouldLoopCustomAnimation="@ShouldLoopCustomAnimation" CustomAnimationWaitDuration="@CustomAnimationWaitDuration" CustomAnimation="@CustomAnimation" LeftHandWieldedEquipmentIndex="@LeftHandWieldedEquipmentIndex" RightHandWieldedEquipmentIndex="@RightHandWieldedEquipmentIndex" DoNotUseCustomScale="true" /> -->
									<!-- <CharacterTableauWidget DataSource="{LeaderPreview}" WidthSizePolicy="Fixed" SuggestedWidth="420" HeightSizePolicy ="Fixed" SuggestedHeight="420" HorizontalAlignment="Center" VerticalAlignment="Bottom" PositionYOffset="42" PositionXOffset="!LeaderPreview.XOffset" BodyProperties="@BodyProperties" IsFemale="@IsFemale" EquipmentCode="@EquipmentCode" CharStringId="@CharStringId" StanceIndex="@StanceIndex" BannerCodeText="@BannerCodeText" MountCreationKey="@MountCreationKey" ArmorColor1="@ArmorColor1" ArmorColor2="@ArmorColor2" Race="@Race" IdleAction="@IdleAction" IsPlayingCustomAnimations="@IsPlayingCustomAnimations" ShouldLoopCustomAnimation="@ShouldLoopCustomAnimation" CustomAnimationWaitDuration="@CustomAnimationWaitDuration" CustomAnimation="@CustomAnimation" LeftHandWieldedEquipmentIndex="@LeftHandWieldedEquipmentIndex" RightHandWieldedEquipmentIndex="@RightHandWieldedEquipmentIndex" DoNotUseCustomScale="true" /> -->
								<!-- </Children> -->
							<!-- </Widget> -->
							<!-- Culture name -->
							<Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="200" SuggestedHeight="100" HorizontalAlignment="Center" VerticalAlignment="Top" PositionXOffset="0" PositionYOffset="0" >
								<Children>
									<RichTextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" PositionYOffset="-20" Brush="MPTeamSelection.SubHeaderText" Brush.FontSize="25" IsDisabled="true" Text="@DisplayedPrimary" />
									<Widget WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="300" SuggestedHeight="16" HorizontalAlignment="Center" VerticalAlignment="Top" PositionXOffset="6" PositionYOffset="-18" Sprite="MPTeamSelection\divider_notched" Color="@CultureColor2"/>
								</Children>
							</Widget>
						</Children>
					</BrushWidget>
				</Children>
			</Widget>




            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" VerticalAlignment="Bottom" HorizontalAlignment="Center" Text="@DisplayedSecondary" PositionYOffset="24" Brush="MPTeamSelection.PlayerCountText"/>
            <TextWidget WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" VerticalAlignment="Bottom" HorizontalAlignment="Center" Text="@DisplayedSecondarySub" PositionYOffset="54" Brush="MPTeamSelection.BotCountText"/>
          </Children>
        </ButtonWidget>

        <Widget DoNotAcceptEvents="true" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" HorizontalAlignment="Center" VerticalAlignment="Center" PositionXOffset="!LockImage.XOffset" PositionYOffset="-40">
          <Children>
            <Widget IsVisible="@IsDisabled" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="!LockBackground.Width" SuggestedHeight="!LockBackground.Height" HorizontalAlignment="Center" Sprite="MPTeamSelection\locked_for_balance" >
              <Children>
                <TextWidget Text="@LockText" WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" PositionYOffset="2" Brush="MPTeamSelection.LockText"/>
              </Children>
            </Widget>
          </Children>
        </Widget>

      </Children>
    </Widget>
  </Window>
</Prefab>